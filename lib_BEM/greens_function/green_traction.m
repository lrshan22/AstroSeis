function [T11, T12, T13,T21,T22,T23,T31, T32, T33]...
    = green_traction (vp,vs,rho,w,...
    x1,x2,x3,xs,ys,zs,sn1,sn2,sn3)
mu =rho*vs*vs; 
lam = rho*vp*vp - 2*mu; 
im = complex(0,1); 
R = sqrt( (x1-xs).^2 + (x2-ys).^2 + (x3-zs).^2); 
g1 = (x1-xs)./R; 
g2 = (x2-ys)./R; 
g3 = (x3-zs)./R; 
kp = w/vp; 
ks = w/vs;
Gs=exp(im*ks*R)./(4*pi*R)./(rho*w^2);
Gp=exp(im*kp*R)./(4*pi*R)./(rho*w^2);
%%
Rp15=15+(im*(-15)).*kp.*R+(-6).*kp.^2.*R.^2+im.*kp.^3.*R.^3;
Rs15=(-15)+(im*15).*ks.*R+6.*ks.^2.*R.^2+(im*(-1)).*ks.^3.*R.^3;
Rp3=(-3)+(im*3).*kp.*R+kp.^2.*R.^2;
Rs9=9+(im*(-9)).*ks.*R+(-4).*ks.^2.*R.^2+im.*ks.^3.*R.^3;
%Rs3=3+(im*(-3)).*ks.*R+(-1).*ks.^2.*R;
Rs3i=3+(im*(-3)).*ks.*R+(-2).*ks.^2.*R.^2+im.*ks.^3.*R.^3; 
GRGR=Gp.*Rp15 + Gs.*Rs15;
%GSR=Gs.*(Rs3 + Rs3i);

%%
T11=R.^(-3).*(g1.^3.*GRGR.*(lam+2.*mu).*sn1+g1.*(g2.^2.*GRGR.*lam+ ...
  g3.^2.*GRGR.*lam+(-2).*Gs.*lam.*((-3)+(im*3).*ks.*R+ks.^2.* ...
  R.^2)+5.*Gp.*lam.*Rp3+6.*Gp.*mu.*Rp3+Gs.*lam.*Rs9+2.*Gs.*mu.*Rs9) ...
  .*sn1+2.*g1.^2.*GRGR.*mu.*(g2.*sn2+g3.*sn3)+mu.*(2.*Gp.*Rp3+Gs.*( ...
  3+(im*(-3)).*ks.*R+(-1).*ks.^2.*R.^2+Rs3i)).*(g2.*sn2+g3.* ...
  sn3));
T12=R.^(-3).*(g1.^2.*g2.*GRGR.*(lam+2.*mu).*sn1+g2.*(g2.^2.*GRGR.*lam+ ...
  g3.^2.*GRGR.*lam+(-2).*Gs.*lam.*((-3)+(im*3).*ks.*R+ks.^2.* ...
  R.^2)+(-2).*Gs.*mu.*((-3)+(im*3).*ks.*R+ks.^2.*R.^2)+5.*Gp.* ...
  lam.*Rp3+2.*Gp.*mu.*Rp3+Gs.*lam.*Rs9).*sn1+g1.*mu.*(2.*g2.^2.* ...
  GRGR.*sn2+(2.*Gp.*Rp3+Gs.*(3+(im*(-3)).*ks.*R+(-1).*ks.^2.* ...
  R.^2+Rs3i)).*sn2+2.*g2.*g3.*GRGR.*sn3));

T13=R.^(-3).*(g1.^2.*g3.*GRGR.*(lam+2.*mu).*sn1+g3.*(g2.^2.*GRGR.*lam+ ...
  g3.^2.*GRGR.*lam+(-2).*Gs.*lam.*((-3)+(im*3).*ks.*R+ks.^2.* ...
  R.^2)+(-2).*Gs.*mu.*((-3)+(im*3).*ks.*R+ks.^2.*R.^2)+5.*Gp.* ...
  lam.*Rp3+2.*Gp.*mu.*Rp3+Gs.*lam.*Rs9).*sn1+g1.*mu.*(2.*g2.*g3.* ...
  GRGR.*sn2+(2.*g3.^2.*GRGR+2.*Gp.*Rp3+Gs.*(3+(im*(-3)).*ks.* ...
  R+(-1).*ks.^2.*R.^2+Rs3i)).*sn3));

T21=R.^(-3).*(2.*g1.^2.*g2.*GRGR.*mu.*sn1+g2.*mu.*(2.*Gp.*Rp3+Gs.*(3+( ...
  im*(-3)).*ks.*R+(-1).*ks.^2.*R.^2+Rs3i)).*sn1+g1.^3.*GRGR.* ...
  lam.*sn2+g1.*(g2.^2.*GRGR.*(lam+2.*mu).*sn2+(g3.^2.*GRGR.*lam+Gp.* ...
  (5.*lam+2.*mu).*Rp3+Gs.*((-2).*mu.*((-3)+(im*3).*ks.*R+ ...
  ks.^2.*R.^2)+lam.*(6+(im*(-6)).*ks.*R+(-2).*ks.^2.*R.^2+Rs9) ...
  )).*sn2+2.*g2.*g3.*GRGR.*mu.*sn3));

T22=R.^(-3).*(g1.*mu.*(2.*g2.^2.*GRGR+2.*Gp.*Rp3+Gs.*(3+(im*(-3) ...
  ).*ks.*R+(-1).*ks.^2.*R.^2+Rs3i)).*sn1+g1.^2.*g2.*GRGR.*lam.*sn2+ ...
  g2.^3.*GRGR.*(lam+2.*mu).*sn2+g2.*(g3.^2.*GRGR.*lam+Gp.*(5.*lam+ ...
  6.*mu).*Rp3+Gs.*(2.*mu.*Rs9+lam.*(6+(im*(-6)).*ks.*R+(-2).* ...
  ks.^2.*R.^2+Rs9))).*sn2+2.*g2.^2.*g3.*GRGR.*mu.*sn3+g3.*mu.*(2.* ...
  Gp.*Rp3+Gs.*(3+(im*(-3)).*ks.*R+(-1).*ks.^2.*R.^2+Rs3i)).* ...
  sn3);

T23=R.^(-3).*(2.*g1.*g2.*g3.*GRGR.*mu.*sn1+g1.^2.*g3.*GRGR.*lam.*sn2+ ...
  g2.^2.*g3.*GRGR.*(lam+2.*mu).*sn2+g3.*(g3.^2.*GRGR.*lam+Gp.*(5.* ...
  lam+2.*mu).*Rp3+Gs.*((-2).*mu.*((-3)+(im*3).*ks.*R+ks.^2.* ...
  R.^2)+lam.*(6+(im*(-6)).*ks.*R+(-2).*ks.^2.*R.^2+Rs9))).* ...
  sn2+g2.*mu.*(2.*g3.^2.*GRGR+2.*Gp.*Rp3+Gs.*(3+(im*(-3)).* ...
  ks.*R+(-1).*ks.^2.*R.^2+Rs3i)).*sn3);

T31=R.^(-3).*(2.*g1.^2.*g3.*GRGR.*mu.*sn1+g3.*mu.*(2.*Gp.*Rp3+Gs.*(3+( ...
  im*(-3)).*ks.*R+(-1).*ks.^2.*R.^2+Rs3i)).*sn1+g1.^3.*GRGR.* ...
  lam.*sn3+g1.*(2.*g2.*g3.*GRGR.*mu.*sn2+g2.^2.*GRGR.*lam.*sn3+( ...
  g3.^2.*GRGR.*(lam+2.*mu)+Gp.*(5.*lam+2.*mu).*Rp3+Gs.*((-2).*mu.*(( ...
  -3)+(im*3).*ks.*R+ks.^2.*R.^2)+lam.*(6+(im*(-6)).*ks.* ...
  R+(-2).*ks.^2.*R.^2+Rs9))).*sn3));

T32=R.^(-3).*(2.*g1.*g2.*g3.*GRGR.*mu.*sn1+2.*g2.^2.*g3.*GRGR.*mu.* ...
  sn2+g3.*mu.*(2.*Gp.*Rp3+Gs.*(3+(im*(-3)).*ks.*R+(-1).* ...
  ks.^2.*R.^2+Rs3i)).*sn2+g1.^2.*g2.*GRGR.*lam.*sn3+g2.^3.*GRGR.* ...
  lam.*sn3+g2.*(g3.^2.*GRGR.*(lam+2.*mu)+Gp.*(5.*lam+2.*mu).*Rp3+ ...
  Gs.*((-2).*mu.*((-3)+(im*3).*ks.*R+ks.^2.*R.^2)+lam.*(6+( ...
  im*(-6)).*ks.*R+(-2).*ks.^2.*R.^2+Rs9))).*sn3);

T33=R.^(-3).*(g1.*mu.*(2.*g3.^2.*GRGR+2.*Gp.*Rp3+Gs.*(3+(im*(-3) ...
  ).*ks.*R+(-1).*ks.^2.*R.^2+Rs3i)).*sn1+g2.*mu.*(2.*g3.^2.*GRGR+2.* ...
  Gp.*Rp3+Gs.*(3+(im*(-3)).*ks.*R+(-1).*ks.^2.*R.^2+Rs3i)).* ...
  sn2+g1.^2.*g3.*GRGR.*lam.*sn3+g2.^2.*g3.*GRGR.*lam.*sn3+g3.*( ...
  g3.^2.*GRGR.*(lam+2.*mu)+Gp.*(5.*lam+6.*mu).*Rp3+Gs.*(2.*mu.*Rs9+ ...
  lam.*(6+(im*(-6)).*ks.*R+(-2).*ks.^2.*R.^2+Rs9))).*sn3);



end